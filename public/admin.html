<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin</title>
<link rel="stylesheet" href="admin.css">
<link rel="icon" href="/img/icon.png" type="image/x-icon">
</head>
<body>
<form id="adminForm">
  <input type="text" placeholder="ID" id="id" required><br>
  <input type="text" placeholder="Nome" id="name" required><br>
  <input type="text" placeholder="Criador" id="creator" required><br>

  <select id="resolution" required>
    <option selected disabled>Resoluções</option>
    <option value="high">High</option>
    <option value="medium">Medium</option>
    <option value="low">Low</option>
    <option value="high-medium">High, Medium</option>
    <option value="high-low">High, Low</option>
    <option value="medium-low">Medium, Low</option>
  </select><br>

  <input type="url" placeholder="URL Download" id="download" required><br>
  <input type="text" placeholder="Descrição" id="description"><br>
  <input type="text" placeholder="Versão" id="version"><br>
  <input type="url" placeholder="URL do ícone" id="icon"><br>
  <input type="url" placeholder="URL da screenshot" id="screenshot"><br>

  <button type="submit">Adicionar Pack</button>
</form>

<script>
// Mesma senha do server.js
const serverPassword = "8D9WJ49FKAS0WIE01K-QWJEFOI3J";

document.getElementById("adminForm").addEventListener("submit", async e => {
    e.preventDefault();

    // Solicita a senha
    const inputPassword = prompt("Digite a senha para adicionar o pack:");
    if (inputPassword !== serverPassword) {
        alert("Senha incorreta!");
        return;
    }

    const pack = {
        id: document.getElementById("id").value,
        name: document.getElementById("name").value,
        creator: document.getElementById("creator").value,
        resolution: document.getElementById("resolution").value.includes("-")
            ? document.getElementById("resolution").value.split("-")
            : [document.getElementById("resolution").value],
        download: document.getElementById("download").value,
        description: document.getElementById("description").value,
        version: document.getElementById("version").value,
        icon: document.getElementById("icon").value,
        screenshot: document.getElementById("screenshot").value,
        downloads: 0
    };

    try {
        const res = await fetch("/api/packs", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(pack)
        });

        const data = await res.json();
        if (data.success) {
            alert("Pack adicionado com sucesso!");
            document.getElementById("adminForm").reset();
        } else {
            alert("Erro ao adicionar pack.");
        }
    } catch(err) {
        console.error(err);
        alert("Erro ao conectar com o servidor.");
    }
});
</script>

</body>
</html>
